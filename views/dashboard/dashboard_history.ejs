<%- include ('../partials/header'); -%>
<%- include('../partials/loader') %>
    <%- include ('../partials/sidebar'); -%>
        <%- include ('../partials/topbar'); -%>



            <!-- Main Container -->
            <div class="container-fluid content-inner mt-4">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">

                                <h3 class="card-title">
									<div class="breadcrumb1 flat">
										<a href="/dashboard"><span class="fa fa-home"></span></a>
										<a href="/dashboard_history" class=" active"><%= __('dashboard_history.reset_history') %></a>
									</div>
								</h3>
                            </div>

                            <div class="card-body">
                                <table id="dashboardhistory-tbl" class="table  nowrap small-text" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th><%= __('dashboard_history.date') %></th>
                                            <th><%= __('dashboard_history.expense') %></th>
                                            <th><%= __('dashboard_history.commission') %></th>
                                            <th><%= __('dashboard_history.total_rolling') %></th>
                                            <th><%= __('dashboard_history.house_rolling') %></th>
                                            <th><%= __('dashboard_history.win_loss') %></th>
                                            <!-- <th><%= __('dashboard_history.ngr') %></th> -->
                                            <th><%= __('dashboard_history.reset_by') %></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <%- include ('../partials/footer'); -%>
<style>
    .card-body {
  overflow-x: auto;
}

     /* Base table styles */
 #dashboardhistory-tbl {
    width: 100%;
    font-size: 13px;
    border-collapse: collapse;
}

/* Header styles */
#dashboardhistory-tbl thead th {
    background: var(--bs-primary-bg-subtle);
    color: var(--bs-primary);
    font-weight: 500;
    padding: 12px 15px;
    text-align: left;
    border: none;
}

/* Row styles */
#dashboardhistory-tbl tbody tr {
    border-bottom: 1px solid #eee;
}

/* Cell styles */
#dashboardhistory-tbl td {
    padding: 12px 15px;
    color: #666;
}

#dashboardhistory-tbl tbody tr:hover {
  background-color: #f5f5f5 !important;
}



/* Balance column */
#dashboardhistory-tbl td:last-child {
   
    color: #333;
}


/* Footer total row */


#dashboardhistory-tbl tfoot th {
    padding: 10px;
    font-weight: 600;
  
    color: #333;
    background-color: #f4f6fa;
    border-top: 2px solid #dee2e6;
}
@media (max-width: 768px) {
    #dashboardhistory-tbl {
        font-size: 10px; /* Mas maliit sa mobile */
    }

    #dashboardhistory-tbl th,
    #dashboardhistory-tbl td {
        padding: 5px;
    }
}
							/* Itago ang text na "Show" at "entries" sa DataTables */
							.dataTables_length label {
								font-size: 0; /* Itatago ang text */
							}
							
							/* Panatilihin ang dropdown na nakikita */
							.dataTables_length select {
								font-size: 12px; /* Ibalik ang font size ng dropdown */
							}
							
							
							
								/* Adjust spacing and alignment for date range picker */
							.dataTables_wrapper .row {
								margin-bottom: 15px;
								font-size: 12px; /* Pareho sa commission-tbl */
							}
							
							/* Flexbox layout for the date range picker */
							.input-daterange {
								display: flex;
								justify-content: space-between;
								position: relative;
								left: 7.5rem;
								top: 4rem;
								max-width: 300px;
								font-size: 12px; /* Pareho sa commission-tbl */
							}
							
							/* Styling for form controls */
							.input-daterange .form-control {
								flex: 1;
								margin-right: 5px;
								max-width: 120px;
								font-size: 12px; /* Pareho sa commission-tbl */
								padding: 8px; /* Pareho sa cell padding ng table */
							}
							
							/* Remove margin from the last input */
							.input-daterange .form-control:last-child {
								margin-right: 0;
							}
							
							/* Responsive tweaks */
							@media (max-width: 768px) {
								.dataTables_wrapper .row,
								.input-daterange,
								.input-daterange .form-control {
									font-size: 10px; /* Mas maliit sa mobile */
								}
							
								.input-daterange .form-control {
									padding: 5px; /* Mas maliit na padding */
								}
							}
</style>
                <script>
                    // Pass translations to JavaScript
                    window.dashboardHistoryTranslations = {
                        search: "<%= __('dashboard_history.search') %>",
                        showing_entries: "<%= __('dashboard_history.showing_entries') %>",
                        previous: "<%= __('dashboard_history.previous') %>",
                        next: "<%= __('dashboard_history.next') %>",
                        no_data_available: "<%= __('dashboard_history.no_data_available') %>",
                        invalid_date: "<%= __('dashboard_history.invalid_date') %>"
                    };

                    $(document).ready(function () {
                        const translations = window.dashboardHistoryTranslations || {};
                        $('#dashboardhistory-tbl').DataTable({
                            "processing": true,
                            "serverSide": false,
                            "ajax": {
                                "url": "/get-dashboard-history",
                                "type": "GET",
                                "dataSrc": function (json) {
                                    console.log("Raw Data Loaded:", json);
                                    return json.map(function (row) {
                                        if (row.ENCODED_DT) {
                                            row.ENCODED_DT_RAW = moment.utc(row.ENCODED_DT, 'YYYY-MM-DD HH:mm:ss').format('YYYY-MM-DD HH:mm:ss'); // Use raw format for sorting
                                            row.ENCODED_DT = moment.utc(row.ENCODED_DT, 'YYYY-MM-DD HH:mm:ss').local().format('MMMM DD, YYYY HH:mm:ss'); // Convert to local time for display
                                        } else {
                                            row.ENCODED_DT = translations.invalid_date || 'Invalid Date';
                                        }
                                        return row;
                                    });
                                }
                            },
                            "language": {
                                "search": translations.search || "Search:",
                                "info": translations.showing_entries || "Showing _START_ to _END_ of _TOTAL_ entries",
                                "paginate": {
                                    "previous": translations.previous || "Previous",
                                    "next": translations.next || "Next"
                                },
                                "emptyTable": translations.no_data_available || "No data available in table"
                            },
                            "order": [[0, 'desc']], // Ensure sorting by latest date
                            "columns": [
                                {
                                    "data": "ENCODED_DT",
                                    "type": "date",
                                    "render": function (data, type, row) {
                                        return type === 'sort' ? row.ENCODED_DT_RAW : row.ENCODED_DT;
                                    }
                                },
                                { "data": "EXPENSE_HISTORY", "render": data => data ? parseFloat(data).toLocaleString() : '-' },
                                { "data": "COMMISSION_HISTORY", "render": data => data ? parseFloat(data).toLocaleString() : '-' },
                                { "data": "TOTAL_ROLLING_HISTORY", "render": data => data ? parseFloat(data).toLocaleString() : '-' },
                                { "data": "HOUSE_ROLLING_HISTORY", "render": data => data ? parseFloat(data).toLocaleString() : '-' },
                                { "data": "WINLOSS_HISTORY", "render": data => data ? parseFloat(data).toLocaleString() : '-' },
                                // { "data": "NGR_HISTORY", "render": data => data ? parseFloat(data).toLocaleString() : '-' },
                                { "data": "FIRSTNAME" }
                            ]
                        });
                    });

                </script>